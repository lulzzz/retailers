!function(){window.retailers=window.retailers||{},retailers.map=function(e,o,t,s,a,n,i){if(document.getElementById(o)){var l,r,d=new google.maps.Geocoder,c=new google.maps.InfoWindow,g=(new google.maps.DirectionsRenderer,new Array);retailers.shop=function(e,o,t,s,n,r){var g=new google.maps.LatLng(e,o);if(l&&l.setMap&&l.setMap(null),d.geocode({location:g},function(e,o){"OK"===o?(p.panTo(g),p.setCenter(g),p.setZoom(15),l=new google.maps.Marker({position:g,map:p}),c.setContent("<address><b>"+e[0].address_components[0].long_name+"&nbsp;"+e[0].address_components[1].long_name+"<br>"+e[0].address_components[5].long_name+"<br>"+e[0].address_components[6].long_name+",&nbsp;"+e[0].address_components[4].long_name+"</b></address>"),c.open(p,l),$(".list").show()):window.alert("Geocoder failed due to: "+o)}),"index"==i){if($(".container-fluid").width()<1e3)var m="200px";else var m="250px";var u=[];if(n)var u='<div class="logo"><img src="'+n+'"></div>';else var u='<div class="logo"><h2>'+s+"</h2></div>";var f="http://maps.google.com/maps?q="+e+","+o,h=$('<div class="storefront-sticker" style="max-width:'+m+';"><a href="/a/retailers-1/'+r+"?shop="+a+'"><div class="sticker" data-sticker>'+u+'</a></div><a class="btn btn-secondary btn-sm mt-1 float-xs-right" href="'+f+'" target="_blank"><i class="icon icon-gmap"></i> &nbsp;View in Google Maps</a>');$("div[data-sticker]").remove(),h.appendTo("div[data-map]")}},retailers.json=function(e){qwest.get(e).then(function(e,o){$("#locating").hide(),$(".list").removeClass("disabled"),"index"==i&&(m.clear(),m.add(o),m.sort("distance"));var t=$(".ref-location");retailers.shop(t.closest("li").first().data("latitude"),t.closest("li").first().data("longitude"),t.closest("li").first().data("country_code"),t.closest("li").first().data("name"),t.closest("li").first().data("logo_md"),t.closest("li").first().data("slug")),t.closest("li").first().addClass("active")}).complete(function(){$(".ref-location").on("click",function(){$(".list > li").removeClass("active"),$(this).toggleClass("active"),store.set("retailer_latitude",$(this).data("latitude")),store.set("retailer_longitude",$(this).data("longitude")),retailers.shop($(this).data("latitude"),$(this).data("longitude"),$(this).data("country_code"),$(this).data("name"),$(this).data("logo_md"),$(this).data("slug"))})})};var p=new google.maps.Map(document.getElementById(o),{styles:styles,zoom:7,mapTypeControl:!1,streetViewControl:!0,center:new google.maps.LatLng(t,s),mapTypeControl:!1,streetViewControl:!0,scrollwheel:!1,mapTypeControl:!0,scaleControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}});for(store.get("latitude")?retailers.json(e+t+"/"+s+"?shop="+a):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){store.set("latitude",o.coords.latitude),store.set("longitude",o.coords.longitude),retailers.json(e+o.coords.latitude+"/"+o.coords.longitude+"?shop="+a)},function(){retailers.json(e+t+"/"+s+"?shop="+a)}):retailers.json(e+t+"/"+s+"?shop="+a),r=0;r<n.length;r++)l=new google.maps.Marker({position:new google.maps.LatLng(n[r][0],n[r][1]),map:p,icon:n[r][5]}),g.push(l),google.maps.event.addListener(l,"click",function(e,o){return function(){retailers.shop(n[o][0],n[o][1],n[o][2],n[o][3],n[o][4])}}(l,r));var m=new List("retailers-list",{valueNames:["name","street_number","street_address","city","country","postcode","street_number","distance",{name:"location",data:["latitude","longitude"]},{name:"country_code",data:["country_code"]},{name:"logo_md",data:["logo_md"]},{name:"slug",data:["slug"]}]})}console.log("Retailers Initialized")}}();