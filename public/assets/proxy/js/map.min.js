!function(){window.retailers=window.retailers||{},retailers.map=function(e,t,o,s,a,i){if(document.getElementById(e)){var n=new google.maps.Geocoder,l=new google.maps.InfoWindow;new google.maps.DirectionsRenderer;retailers.shop=function(e,t,o,a,d,c){var p=new google.maps.LatLng(e,t);if(r&&r.setMap&&r.setMap(null),n.geocode({location:p},function(o,s){if("OK"===s){g.panTo(p),g.setCenter(p),g.setZoom(15),r=new google.maps.Marker({position:p,map:g});var a=$("#hook").parent().parent().parent().siblings();a.parent().parent().parent().siblings().addClass("hidden"),l.setContent('<div id="hook" class="info-window"><div class="sticker"><div class="logo"><img src="'+d+'"></div><div class="storefront"><img src="https://maps.googleapis.com/maps/api/streetview?size=600x300&location='+e+","+t+'&heading=151.78&pitch=-0.76&key=AIzaSyAMElu9QAKi3qU68wXQ5yJSCG_YNWVU3do""></div></div></div>'),l.open(g,r),$(".list").show()}else window.alert("Geocoder failed due to: "+s)}),"index"==i){if($(".container-fluid").width()<1e3)var m="200px";else var m="250px";var u=[];if(d)var u='<div class="logo"><img src="'+d+'"></div>';else var u='<div class="logo"><h2>'+a+"</h2></div>";var v="http://maps.google.com/maps?q="+e+","+t,h=$('<div class="storefront-sticker" style="max-width:'+m+';"><a href="/a/retailers-1/'+c+"?shop="+s+'"><div class="sticker" data-sticker>'+u+'</a></div><a class="btn btn-secondary btn-sm mt-1 float-xs-right" href="'+v+'" target="_blank"><i class="icon icon-gmap"></i> &nbsp;View in Google Maps</a>');$("div[data-sticker]").remove(),h.appendTo("div[data-map]")}},retailers.json=function(e){qwest.get(e).then(function(e,t){$("#locating").hide(),$(".list").removeClass("disabled"),"index"==i&&(p.clear(),p.add(t),p.sort("distance"));var o=$(".ref-location");retailers.shop(o.closest("li").first().data("latitude"),o.closest("li").first().data("longitude"),o.closest("li").first().data("country_code"),o.closest("li").first().data("name"),o.closest("li").first().data("logo_md"),o.closest("li").first().data("slug")),o.closest("li").first().addClass("active")}).complete(function(){$(".ref-location").on("click",function(){$(".list > li").removeClass("active"),$(this).toggleClass("active"),store.set("retailer_latitude",$(this).data("latitude")),store.set("retailer_longitude",$(this).data("longitude")),retailers.shop($(this).data("latitude"),$(this).data("longitude"),$(this).data("country_code"),$(this).data("name"),$(this).data("logo_md"),$(this).data("slug"))})})};var r,d,c=new Array,g=new google.maps.Map(document.getElementById(e),{styles:styles,zoom:7,mapTypeControl:!1,streetViewControl:!0,center:new google.maps.LatLng(t,o),mapTypeControl:!1,streetViewControl:!0,scrollwheel:!1,mapTypeControl:!0,scaleControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}});for(store.get("latitude")?retailers.json("/a/retailers/"+t+"/"+o+"?shop="+s):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){store.set("latitude",e.coords.latitude),store.set("longitude",e.coords.longitude),retailers.json("/a/retailers/"+e.coords.latitude+"/"+e.coords.longitude+"?shop="+s)},function(){retailers.json("/a/retailers/"+t+"/"+o+"?shop="+s)}):retailers.json("/a/retailers/"+t+"/"+o+"?shop="+s),d=0;d<a.length;d++)r=new google.maps.Marker({position:new google.maps.LatLng(a[d][0],a[d][1]),map:g,icon:a[d][5]}),c.push(r),google.maps.event.addListener(r,"click",function(e,t){return function(){retailers.shop(a[t][0],a[t][1],a[t][2],a[t][3],a[t][4])}}(r,d));var p=new List("retailers-list",{valueNames:["name","street_number","street_address","city","country","postcode","street_number","distance",{name:"location",data:["latitude","longitude"]},{name:"country_code",data:["country_code"]},{name:"logo_md",data:["logo_md"]},{name:"slug",data:["slug"]}]})}console.log("Retailers Initialized")}}();